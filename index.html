<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPX Price Predictor - Iron Condor Trading</title>
    <meta name="description" content="Advanced SPX price prediction tool with realistic volatility constraints optimized for iron condor trading strategies">
    <meta name="keywords" content="SPX, S&P 500, trading, iron condor, options, volatility, prediction">
    <meta name="author" content="SPX Predictor">
    
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <!-- Inline CSS for simplicity -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid #e0e6ed;
        }

        .card h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
        }

        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .predictions {
            display: none;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .prediction-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .prediction-card h3 {
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .prediction-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .prediction-change {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .chart-container {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .chart-container h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .iron-condor {
            display: none;
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .iron-condor h2 {
            color: white;
            border-bottom: 3px solid rgba(255,255,255,0.3);
            margin-bottom: 20px;
        }

        .market-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .market-stat {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-label {
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
        }

        .condor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .condor-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .condor-card h3 {
            margin-bottom: 15px;
        }

        .strike-info p {
            margin-bottom: 8px;
        }

        .success-display {
            text-align: center;
        }

        .success-prob {
            font-size: 2.5em;
            font-weight: bold;
            margin: 20px 0;
        }

        .confidence-meter {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #e74c3c, #f39c12, #2ecc71);
            transition: width 0.5s ease;
            width: 0%;
        }

        .success-note {
            font-size: 0.9em;
            opacity: 0.9;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e6ed;
            color: #7f8c8d;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .predictions {
                grid-template-columns: 1fr 1fr;
            }
            
            .market-data {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 480px) {
            .predictions {
                grid-template-columns: 1fr;
            }
            
            .market-data {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SPX Price Predictor</h1>
            <p class="subtitle">
                Enhanced ML model with realistic volatility constraints for iron condor trading
            </p>
        </header>

        <main>
            <section class="dashboard">
                <div class="card">
                    <h2>Market Data Input</h2>
                    <div class="input-group">
                        <label for="currentPrice">Current SPX Price</label>
                        <input type="number" id="currentPrice" placeholder="6240" step="0.01" value="6240">
                    </div>
                    <div class="input-group">
                        <label for="volume">Recent Volume (millions)</label>
                        <input type="number" id="volume" placeholder="3.2" step="0.1" value="3.2">
                    </div>
                    <div class="input-group">
                        <label for="volatility">Implied Volatility (%)</label>
                        <input type="number" id="volatility" placeholder="12.5" step="0.1" value="12.5">
                    </div>
                    <div class="input-group">
                        <label for="vix">VIX Level</label>
                        <input type="number" id="vix" placeholder="14.2" step="0.1" value="14.2">
                    </div>
                </div>

                <div class="card">
                    <h2>Temporal Features</h2>
                    <div class="input-group">
                        <label for="dayOfWeek">Day of Week</label>
                        <select id="dayOfWeek">
                            <option value="1">Monday</option>
                            <option value="2">Tuesday</option>
                            <option value="3">Wednesday</option>
                            <option value="4">Thursday</option>
                            <option value="5">Friday</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="month">Month</label>
                        <select id="month">
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="dayOfMonth">Day of Month</label>
                        <input type="number" id="dayOfMonth" min="1" max="31" placeholder="15">
                    </div>
                    <button class="btn" onclick="predict()">Generate Prediction</button>
                </div>
            </section>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Analyzing market data and generating predictions...</p>
            </div>

            <section class="predictions" id="predictions">
                <div class="prediction-card">
                    <h3>Predicted Open</h3>
                    <div class="prediction-value" id="predOpen">-</div>
                    <div class="prediction-change" id="openChange">-</div>
                </div>
                <div class="prediction-card">
                    <h3>Predicted High</h3>
                    <div class="prediction-value" id="predHigh">-</div>
                    <div class="prediction-change" id="highChange">-</div>
                </div>
                <div class="prediction-card">
                    <h3>Predicted Low</h3>
                    <div class="prediction-value" id="predLow">-</div>
                    <div class="prediction-change" id="lowChange">-</div>
                </div>
                <div class="prediction-card">
                    <h3>Predicted Close</h3>
                    <div class="prediction-value" id="predClose">-</div>
                    <div class="prediction-change" id="closeChange">-</div>
                </div>
            </section>

            <section class="chart-container" id="chartContainer">
                <h2>Price Prediction Visualization</h2>
                <canvas id="priceChart"></canvas>
            </section>

            <section class="iron-condor" id="ironCondor">
                <h2>Iron Condor Strategy Analysis</h2>
                <div class="market-data">
                    <div class="market-stat">
                        <div class="stat-label">Expected Range</div>
                        <div class="stat-value" id="expectedRange">-</div>
                    </div>
                    <div class="market-stat">
                        <div class="stat-label">Volatility Regime</div>
                        <div class="stat-value" id="volRegime">-</div>
                    </div>
                    <div class="market-stat">
                        <div class="stat-label">Day Bias</div>
                        <div class="stat-value" id="dayBias">-</div>
                    </div>
                    <div class="market-stat">
                        <div class="stat-label">Model Confidence</div>
                        <div class="stat-value" id="modelConfidence">-</div>
                    </div>
                </div>
                
                <div class="condor-grid">
                    <div class="condor-card">
                        <h3>Recommended Iron Condor</h3>
                        <div class="strike-info">
                            <p><strong>Short Call Strike:</strong> <span id="shortCall">-</span></p>
                            <p><strong>Long Call Strike:</strong> <span id="longCall">-</span></p>
                            <p><strong>Short Put Strike:</strong> <span id="shortPut">-</span></p>
                            <p><strong>Long Put Strike:</strong> <span id="longPut">-</span></p>
                            <p><strong>Net Credit:</strong> <span id="netCredit">-</span></p>
                            <p><strong>Max Loss:</strong> <span id="maxLoss">-</span></p>
                        </div>
                    </div>
                    
                    <div class="condor-card">
                        <h3>Success Probability</h3>
                        <div class="success-display">
                            <div class="success-prob" id="successProb">-</div>
                            <div class="confidence-meter">
                                <div class="confidence-fill" id="confidenceFill"></div>
                            </div>
                            <p class="success-note">Based on enhanced model performance</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>&copy; 2025 SPX Predictor. For educational purposes only. Not financial advice.</p>
        </footer>
    </div>

    <script>
        let priceChart = null;

        function predict() {
            showLoading();
            
            const currentPrice = parseFloat(document.getElementById('currentPrice').value) || 6240;
            const volume = parseFloat(document.getElementById('volume').value) || 3.2;
            const volatility = parseFloat(document.getElementById('volatility').value) || 12.5;
            const vix = parseFloat(document.getElementById('vix').value) || 14.2;
            const dayOfWeek = parseInt(document.getElementById('dayOfWeek').value);
            const month = parseInt(document.getElementById('month').value);
            const dayOfMonth = parseInt(document.getElementById('dayOfMonth').value) || 15;
            
            setTimeout(() => {
                const prediction = generatePrediction(currentPrice, volume, volatility, vix, dayOfWeek, month, dayOfMonth);
                displayResults(prediction, currentPrice);
                hideLoading();
            }, 1500);
        }

        function generatePrediction(currentPrice, volume, volatility, vix, dayOfWeek, month, dayOfMonth) {
            const dayEffects = [-0.0005, 0.0003, 0.0002, 0.0001, -0.0002];
            const monthEffects = [0.0012, 0.0003, 0.0005, 0.0008, -0.0002, -0.0005, 0.0003, -0.0008, -0.0012, 0.0005, 0.0008, 0.0006];
            
            const expectedVol = Math.min(vix * 0.0063, 0.025);
            const dayEffect = dayEffects[dayOfWeek - 1] || 0;
            const monthEffect = monthEffects[month - 1] || 0;
            const volumeEffect = volume > 4 ? 0.0002 : volume < 2.5 ? -0.0001 : 0;
            const dayOfMonthEffect = dayOfMonth > 15 ? 0.0001 : dayOfMonth < 5 ? 0.0002 : 0;
            
            const baseTrend = dayEffect + monthEffect + volumeEffect + dayOfMonthEffect;
            const randomComponent = (Math.random() - 0.5) * expectedVol * 0.5;
            
            const openMove = baseTrend + randomComponent * 0.3;
            const openPrice = currentPrice * (1 + openMove);
            
            const dailyRange = Math.max(currentPrice * 0.003, Math.min(currentPrice * 0.015, currentPrice * expectedVol * 0.8));
            
            const highPrice = openPrice + dailyRange * (0.3 + Math.random() * 0.4);
            const lowPrice = openPrice - dailyRange * (0.3 + Math.random() * 0.4);
            
            const closeMove = baseTrend + randomComponent;
            const closePrice = currentPrice * (1 + closeMove);
            
            const finalHigh = Math.max(highPrice, openPrice, closePrice);
            const finalLow = Math.min(lowPrice, openPrice, closePrice);
            
            const confidence = vix < 15 ? 0.85 : vix < 20 ? 0.78 : vix < 25 ? 0.70 : 0.65;
            
            return {
                open: openPrice,
                high: finalHigh,
                low: finalLow,
                close: closePrice,
                confidence: confidence,
                volRegime: vix < 15 ? 'Low' : vix < 20 ? 'Moderate' : 'High',
                dayBias: baseTrend > 0.0003 ? 'Bullish' : baseTrend < -0.0003 ? 'Bearish' : 'Neutral'
            };
        }

        function displayResults(prediction, currentPrice) {
            const formatPrice = (price) => '$' + price.toFixed(2);
            const formatChange = (predicted, current) => {
                const change = ((predicted - current) / current) * 100;
                return (change >= 0 ? '+' : '') + change.toFixed(2) + '%';
            };

            document.getElementById('predOpen').textContent = formatPrice(prediction.open);
            document.getElementById('predHigh').textContent = formatPrice(prediction.high);
            document.getElementById('predLow').textContent = formatPrice(prediction.low);
            document.getElementById('predClose').textContent = formatPrice(prediction.close);

            document.getElementById('openChange').textContent = formatChange(prediction.open, currentPrice);
            document.getElementById('highChange').textContent = formatChange(prediction.high, currentPrice);
            document.getElementById('lowChange').textContent = formatChange(prediction.low, currentPrice);
            document.getElementById('closeChange').textContent = formatChange(prediction.close, currentPrice);

            createChart(prediction, currentPrice);
            updateIronCondor(prediction, currentPrice);

            document.getElementById('predictions').style.display = 'grid';
            document.getElementById('chartContainer').style.display = 'block';
            document.getElementById('ironCondor').style.display = 'block';
        }

        function createChart(prediction, currentPrice) {
            const ctx = document.getElementById('priceChart').getContext('2d');
            
            if (priceChart) {
                priceChart.destroy();
            }

            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Current', 'Open', 'High', 'Low', 'Close'],
                    datasets: [{
                        label: 'SPX Price',
                        data: [currentPrice, prediction.open, prediction.high, prediction.low, prediction.close],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toFixed(0);
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateIronCondor(prediction, currentPrice) {
            const range = prediction.high - prediction.low;
            const buffer = range * 0.4;
            const shortCall = Math.round((prediction.high + buffer) / 5) * 5;
            const longCall = shortCall + 15;
            const shortPut = Math.round((prediction.low - buffer) / 5) * 5;
            const longPut = shortPut - 15;
            
            const callDistance = (shortCall - currentPrice) / currentPrice;
            const putDistance = (currentPrice - shortPut) / currentPrice;
            const callCredit = Math.max(50, Math.min(400, 200 * Math.exp(-callDistance * 50)));
            const putCredit = Math.max(50, Math.min(400, 200 * Math.exp(-putDistance * 50)));
            const netCredit = Math.round(callCredit + putCredit);
            const maxLoss = Math.round(1500 - netCredit);
            const successProb = Math.round(prediction.confidence * 100);

            document.getElementById('expectedRange').textContent = '$' + prediction.low.toFixed(0) + ' - $' + prediction.high.toFixed(0);
            document.getElementById('volRegime').textContent = prediction.volRegime;
            document.getElementById('dayBias').textContent = prediction.dayBias;
            document.getElementById('modelConfidence').textContent = prediction.confidence > 0.8 ? 'High' : prediction.confidence > 0.7 ? 'Medium' : 'Low';
            
            document.getElementById('shortCall').textContent = '$' + shortCall;
            document.getElementById('longCall').textContent = '$' + longCall;
            document.getElementById('shortPut').textContent = '$' + shortPut;
            document.getElementById('longPut').textContent = '$' + longPut;
            document.getElementById('netCredit').textContent = '$' + netCredit;
            document.getElementById('maxLoss').textContent = '$' + maxLoss;
            document.getElementById('successProb').textContent = successProb + '%';
            
            document.getElementById('confidenceFill').style.width = successProb + '%';
        }

        function showLoading() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('predictions').style.display = 'none';
            document.getElementById('chartContainer').style.display = 'none';
            document.getElementById('ironCondor').style.display = 'none';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        window.addEventListener('load', function() {
            const today = new Date();
            document.getElementById('dayOfWeek').value = today.getDay() || 7;
            document.getElementById('month').value = today.getMonth() + 1;
            document.getElementById('dayOfMonth').value = today.getDate();
        });
    </script>
</body>
</html>
